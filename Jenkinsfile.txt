pipeline {
    agent {docker {image 'python:3.8-slim-buster'}}
    agent {docker {image 'mysql'}}
    
    environment {
        MYSQL_DATABASE: inventory
        MYSQL_ROOT_USER: root
        MYSQL_ROOT_PASSWORD: p@ssw0rd!
    }
    
    stages {
        stage('1-Build') {
            steps {
                sh "pip3 install -r requirements.txt"
                echo "Running pip3"
            }
        }
        stage('2-Run') {
            steps {
                echo "Run app"
                sh "python3 -m flask run --host=0.0.0.0"
            }
        }
    }
}